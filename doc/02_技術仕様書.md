# lecsy æŠ€è¡“ä»•æ§˜æ›¸

## ğŸ“‹ ç›®æ¬¡

1. [ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
2. [æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯](#æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯)
3. [ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼](#ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼)
4. [APIè¨­è¨ˆ](#apiè¨­è¨ˆ)
5. [ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)

---

## ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### å…¨ä½“æ§‹æˆå›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              lecsy ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         iOS App (Swift)        â”‚    â”‚      Web App (Next.js)         â”‚  â”‚
â”‚  â”‚                                â”‚    â”‚                                â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚Recording â”‚  â”‚Transcribeâ”‚   â”‚    â”‚  â”‚  Pages   â”‚  â”‚Componentsâ”‚   â”‚  â”‚
â”‚  â”‚  â”‚ Service  â”‚  â”‚ Service  â”‚   â”‚    â”‚  â”‚(App Dir) â”‚  â”‚          â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â”‚    â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚       â”‚             â”‚         â”‚    â”‚       â”‚             â”‚         â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”   â”‚    â”‚  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚     Local Storage      â”‚   â”‚    â”‚  â”‚   Supabase Client     â”‚   â”‚  â”‚
â”‚  â”‚  â”‚   (SQLite/CoreData)    â”‚   â”‚    â”‚  â”‚   (supabase-js)       â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚               â”‚               â”‚    â”‚               â”‚               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                  â”‚                                    â”‚                  â”‚
â”‚                  â”‚         HTTPS (REST API)           â”‚                  â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                 â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                          Supabase                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚    Auth     â”‚  â”‚   Postgres  â”‚  â”‚    Edge     â”‚  â”‚  Stripe  â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ (OAuth)     â”‚  â”‚     DB      â”‚  â”‚  Functions  â”‚  â”‚ Webhook  â”‚  â”‚   â”‚
â”‚  â”‚  â”‚             â”‚  â”‚             â”‚  â”‚             â”‚  â”‚          â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Google    â”‚  â”‚ â€¢ transcriptsâ”‚ â”‚ â€¢ save-     â”‚  â”‚ â€¢ èª²é‡‘   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Apple     â”‚  â”‚ â€¢ summaries â”‚  â”‚   transcriptâ”‚  â”‚   çŠ¶æ…‹   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚             â”‚  â”‚ â€¢ subscript-â”‚  â”‚ â€¢ summarize â”‚  â”‚   åŒæœŸ   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚             â”‚  â”‚   ions      â”‚  â”‚             â”‚  â”‚          â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚                                                                    â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚                    Row Level Security (RLS)                  â”‚  â”‚   â”‚
â”‚  â”‚  â”‚              auth.uid() = user_id ã§å®Œå…¨éš”é›¢                  â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                      External Services                             â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚   â”‚
â”‚  â”‚  â”‚   OpenAI    â”‚  â”‚   Stripe    â”‚  â”‚   Vercel    â”‚                 â”‚   â”‚
â”‚  â”‚  â”‚   (AI API)  â”‚  â”‚  (æ±ºæ¸ˆ)     â”‚  â”‚ (Hosting)   â”‚                 â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### iOS App

| ã‚«ãƒ†ã‚´ãƒª | æŠ€è¡“ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç”¨é€” |
|---------|------|-----------|------|
| è¨€èª | Swift | 5.0+ | ãƒ¡ã‚¤ãƒ³è¨€èª |
| UI | SwiftUI | iOS 17.6+ | UIãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ |
| éŒ²éŸ³ | AVFoundation | - | éŸ³å£°éŒ²éŸ³ãƒ»å†ç”Ÿ |
| æ–‡å­—èµ·ã“ã— | WhisperKit | 0.9.0+ | ãƒ­ãƒ¼ã‚«ãƒ«AIå‡¦ç† |
| Live Activities | ActivityKit | iOS 17.0+ | ãƒ­ãƒƒã‚¯ç”»é¢è¡¨ç¤º |
| ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆ | WidgetKit | iOS 17.0+ | ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆãƒ»Live Activities |
| ãƒ­ãƒƒã‚¯ç”»é¢åˆ¶å¾¡ | MediaPlayer | - | MPRemoteCommandCenter |
| èªè¨¼ | Supabase Swift | 2.0+ | OAuthèªè¨¼ |
| ãƒ­ãƒ¼ã‚«ãƒ«DB | SQLite/CoreData | - | è¬›ç¾©ãƒ‡ãƒ¼ã‚¿ä¿å­˜ |
| éåŒæœŸå‡¦ç† | Combine | - | ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ– |

### Web App

| ã‚«ãƒ†ã‚´ãƒª | æŠ€è¡“ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç”¨é€” |
|---------|------|-----------|------|
| ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ | Next.js | 14+ | App Routerä½¿ç”¨ |
| è¨€èª | TypeScript | 5.0+ | å‹å®‰å…¨ |
| ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚° | Tailwind CSS | 3.0+ | ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£CSS |
| UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | shadcn/ui | - | Radix UIãƒ™ãƒ¼ã‚¹ |
| èªè¨¼ | Supabase Auth | - | OAuthèªè¨¼ |
| ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ | Supabase JS | 2.0+ | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆSDK |
| ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚° | Vercel | - | ã‚¨ãƒƒã‚¸ãƒ‡ãƒ—ãƒ­ã‚¤ |

### Backend (Supabase)

| ã‚«ãƒ†ã‚´ãƒª | æŠ€è¡“ | ç”¨é€” |
|---------|------|------|
| èªè¨¼ | Supabase Auth | Google/Apple OAuth |
| ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ | PostgreSQL | RLSä»˜ãDB |
| API | PostgREST | è‡ªå‹•REST API |
| Functions | Edge Functions (Deno) | ã‚«ã‚¹ã‚¿ãƒ API |
| ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ | Supabase Storage | å°†æ¥ã®ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜ |

### å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹

| ã‚µãƒ¼ãƒ“ã‚¹ | ç”¨é€” |
|---------|------|
| OpenAI API | AIè¦ç´„ç”Ÿæˆï¼ˆGPT-4 Turboï¼‰ |
| Stripe | æ±ºæ¸ˆå‡¦ç† |
| App Store Connect | iOSèª²é‡‘ï¼ˆæ¤œè¨ä¸­ï¼‰ |

---

## ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

### 1. éŒ²éŸ³ãƒ»æ–‡å­—èµ·ã“ã—ãƒ•ãƒ­ãƒ¼ï¼ˆiOSï¼‰

```
ãƒ¦ãƒ¼ã‚¶ãƒ¼: éŒ²éŸ³é–‹å§‹
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RecordingService                                            â”‚
â”‚  â”œâ”€ AVAudioSessionè¨­å®š (.playAndRecord)                     â”‚
â”‚  â”œâ”€ AVAudioRecorderé–‹å§‹                                     â”‚
â”‚  â”œâ”€ Live Activityé–‹å§‹                                       â”‚
â”‚  â””â”€ ã‚¿ã‚¤ãƒãƒ¼é–‹å§‹ï¼ˆ0.1ç§’é–“éš”ï¼‰                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
ãƒ¦ãƒ¼ã‚¶ãƒ¼: éŒ²éŸ³åœæ­¢
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RecordingService                                            â”‚
â”‚  â”œâ”€ AVAudioRecorderåœæ­¢                                     â”‚
â”‚  â”œâ”€ éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜ (Documents/recording_{timestamp}.m4a)  â”‚
â”‚  â”œâ”€ Live Activityçµ‚äº†                                       â”‚
â”‚  â””â”€ RecordingStore ã«è¿½åŠ                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TranscriptionService                                        â”‚
â”‚  â”œâ”€ WhisperKit ãƒ¢ãƒ‡ãƒ«èª­ã¿è¾¼ã¿ï¼ˆåˆå›ã®ã¿ï¼‰                    â”‚
â”‚  â”œâ”€ éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†                                        â”‚
â”‚  â”œâ”€ æ–‡å­—èµ·ã“ã—å®Ÿè¡Œï¼ˆè¨€èª: è‡ªå‹•/æ—¥æœ¬èª/è‹±èªï¼‰                 â”‚
â”‚  â””â”€ çµæœã‚’ RecordingItem ã«ä¿å­˜                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LocalStorage (SQLite/CoreData)                              â”‚
â”‚  â””â”€ Lecture {                                               â”‚
â”‚       lecture_id, title, created_at, duration,              â”‚
â”‚       audio_path, transcript_text, transcript_status,       â”‚
â”‚       saved_to_web, web_transcript_id                       â”‚
â”‚     }                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Save to Web ãƒ•ãƒ­ãƒ¼

```
ãƒ¦ãƒ¼ã‚¶ãƒ¼: Save to Web æŠ¼ä¸‹
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ èªè¨¼ãƒã‚§ãƒƒã‚¯                                                 â”‚
â”‚  â””â”€ æœªãƒ­ã‚°ã‚¤ãƒ³ â†’ ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã¸                              â”‚
â”‚     ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ â†’ ç¶šè¡Œ                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ iOS App                                                     â”‚
â”‚  â””â”€ POST /functions/v1/save-transcript                      â”‚
â”‚     {                                                       â”‚
â”‚       title: "è¬›ç¾©ã‚¿ã‚¤ãƒˆãƒ«",                                â”‚
â”‚       content: "æ–‡å­—èµ·ã“ã—ãƒ†ã‚­ã‚¹ãƒˆ...",                     â”‚
â”‚       created_at: "2026-01-26T10:00:00Z",                   â”‚
â”‚       duration: 3600,                                       â”‚
â”‚       language: "ja"                                        â”‚
â”‚     }                                                       â”‚
â”‚     Headers: { Authorization: Bearer <access_token> }       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Supabase Edge Function (save-transcript)                    â”‚
â”‚  â”œâ”€ èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³æ¤œè¨¼                                        â”‚
â”‚  â”œâ”€ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³                                          â”‚
â”‚  â”œâ”€ word_countè¨ˆç®—                                          â”‚
â”‚  â””â”€ INSERT INTO transcripts                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PostgreSQL (transcripts ãƒ†ãƒ¼ãƒ–ãƒ«)                           â”‚
â”‚  â””â”€ RLS: auth.uid() = user_id ã§éš”é›¢                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ iOS App                                                     â”‚
â”‚  â”œâ”€ web_transcript_id ã‚’ä¿å­˜                                â”‚
â”‚  â”œâ”€ saved_to_web = true                                     â”‚
â”‚  â””â”€ UIæ›´æ–°: "Saved to Web" è¡¨ç¤º                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. AIè¦ç´„ãƒ•ãƒ­ãƒ¼ï¼ˆWebï¼‰

```
ãƒ¦ãƒ¼ã‚¶ãƒ¼: Summarize æŠ¼ä¸‹
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Proãƒã‚§ãƒƒã‚¯                                                  â”‚
â”‚  â””â”€ éPro â†’ èª²é‡‘å°ç·šã¸                                       â”‚
â”‚     Pro â†’ ç¶šè¡Œ                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒã‚§ãƒƒã‚¯                                           â”‚
â”‚  â””â”€ æ—¢å­˜ã‚ã‚Š â†’ ã‚­ãƒ£ãƒƒã‚·ãƒ¥è¡¨ç¤º                                â”‚
â”‚     ãªã— â†’ AIç”Ÿæˆ                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Web App                                                     â”‚
â”‚  â””â”€ POST /functions/v1/summarize                            â”‚
â”‚     { transcript_id: "uuid" }                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Supabase Edge Function (summarize)                          â”‚
â”‚  â”œâ”€ ProçŠ¶æ…‹ãƒã‚§ãƒƒã‚¯                                         â”‚
â”‚  â”œâ”€ ãƒ•ã‚§ã‚¢ãƒªãƒŸãƒƒãƒˆãƒã‚§ãƒƒã‚¯                                   â”‚
â”‚  â”œâ”€ transcriptsã‹ã‚‰ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å–å¾—                           â”‚
â”‚  â”œâ”€ OpenAI APIå‘¼ã³å‡ºã—                                      â”‚
â”‚  â””â”€ summariesãƒ†ãƒ¼ãƒ–ãƒ«ã«ä¿å­˜                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Web App                                                     â”‚
â”‚  â””â”€ è¦ç´„çµæœã‚’è¡¨ç¤º                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## APIè¨­è¨ˆ

### Edge Functions

#### POST /functions/v1/save-transcript

**Purpose**: iOSã‹ã‚‰ã®æ–‡å­—èµ·ã“ã—ãƒ†ã‚­ã‚¹ãƒˆä¿å­˜

**Request:**
```json
{
  "title": "2026å¹´1æœˆ26æ—¥ çµŒæ¸ˆå­¦å…¥é–€",
  "content": "æœ¬æ—¥ã®è¬›ç¾©ã§ã¯...",
  "created_at": "2026-01-26T10:00:00Z",
  "duration": 3600,
  "language": "ja",
  "app_version": "1.0.0"
}
```

**Response (Success):**
```json
{
  "id": "uuid",
  "created_at": "2026-01-26T10:00:00Z"
}
```

**Response (Error):**
```json
{
  "error": "Content is required",
  "code": "VALIDATION_ERROR"
}
```

---

#### POST /functions/v1/summarize

**Purpose**: AIè¦ç´„ç”Ÿæˆ

**Request:**
```json
{
  "transcript_id": "uuid",
  "mode": "summary" | "exam"
}
```

**Response (Success - Summary):**
```json
{
  "id": "uuid",
  "summary": "ã“ã®è¬›ç¾©ã§ã¯...",
  "key_points": [
    "ãƒã‚¤ãƒ³ãƒˆ1",
    "ãƒã‚¤ãƒ³ãƒˆ2"
  ],
  "sections": [
    {
      "heading": "å°å…¥",
      "content": "..."
    }
  ]
}
```

**Response (Success - Exam):**
```json
{
  "id": "uuid",
  "key_terms": [
    { "term": "GDP", "definition": "..." }
  ],
  "questions": [
    {
      "question": "GDPã¨ã¯ä½•ã‹ï¼Ÿ",
      "answer": "..."
    }
  ],
  "predictions": [
    "GDPã®è¨ˆç®—æ–¹æ³•ã«ã¤ã„ã¦å•ã‚ã‚Œã‚‹å¯èƒ½æ€§ãŒé«˜ã„"
  ]
}
```

---

#### POST /functions/v1/stripe-webhook

**Purpose**: Stripe Webhookå‡¦ç†

**Events:**
- `checkout.session.completed`: ã‚µãƒ–ã‚¹ã‚¯é–‹å§‹
- `invoice.paid`: æ”¯æ‰•ã„æˆåŠŸ
- `customer.subscription.deleted`: ã‚µãƒ–ã‚¹ã‚¯è§£ç´„

---

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### èªè¨¼ãƒ•ãƒ­ãƒ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Client  â”‚       â”‚  Supabase   â”‚       â”‚Google/Apple â”‚
â”‚(iOS/Web)â”‚       â”‚    Auth     â”‚       â”‚   OAuth     â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
     â”‚                   â”‚                      â”‚
     â”‚  1. Login Request â”‚                      â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                      â”‚
     â”‚                   â”‚  2. OAuth Redirect   â”‚
     â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                   â”‚                      â”‚
     â”‚                   â”‚  3. Auth Code        â”‚
     â”‚                   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                   â”‚                      â”‚
     â”‚  4. Access Token  â”‚                      â”‚
     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚
     â”‚                   â”‚                      â”‚
     â”‚  5. API Request   â”‚                      â”‚
     â”‚  (Bearer Token)   â”‚                      â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                      â”‚
     â”‚                   â”‚                      â”‚
```

### RLS ãƒãƒªã‚·ãƒ¼

```sql
-- transcripts: è‡ªåˆ†ã®ã‚‚ã®ã ã‘ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
CREATE POLICY "Users can view own transcripts"
  ON transcripts FOR SELECT
  USING (auth.uid() = user_id);

CREATE POLICY "Users can insert own transcripts"
  ON transcripts FOR INSERT
  WITH CHECK (auth.uid() = user_id);

CREATE POLICY "Users can update own transcripts"
  ON transcripts FOR UPDATE
  USING (auth.uid() = user_id);

-- summaries: è‡ªåˆ†ã®ã‚‚ã®ã ã‘ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
CREATE POLICY "Users can view own summaries"
  ON summaries FOR SELECT
  USING (auth.uid() = user_id);

-- subscriptions: è‡ªåˆ†ã®ã‚‚ã®ã ã‘é–²è¦§å¯èƒ½ï¼ˆæ›´æ–°ã¯ã‚µãƒ¼ãƒãƒ¼ã®ã¿ï¼‰
CREATE POLICY "Users can view own subscription"
  ON subscriptions FOR SELECT
  USING (auth.uid() = user_id);
```

### API ã‚­ãƒ¼ç®¡ç†

| ã‚­ãƒ¼ | ä¿å­˜å ´æ‰€ | ã‚¢ã‚¯ã‚»ã‚¹ |
|------|---------|---------|
| Supabase Anon Key | iOS/Web ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ | å…¬é–‹OK (RLSã§ä¿è­·) |
| Supabase Service Role Key | Edge Functions ã®ã¿ | ç§˜å¯† |
| OpenAI API Key | Edge Functions ã®ã¿ | ç§˜å¯† |
| Stripe Secret Key | Edge Functions ã®ã¿ | ç§˜å¯† |
| Stripe Webhook Secret | Edge Functions ã®ã¿ | ç§˜å¯† |

---

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨­è¨ˆ

### iOS

| é …ç›® | å¯¾ç­– |
|------|------|
| ãƒ¡ãƒ¢ãƒªç®¡ç† | `[weak self]` ä½¿ç”¨ã€ãƒ¢ãƒ‡ãƒ«ã®ã‚¢ãƒ³ãƒ­ãƒ¼ãƒ‰ |
| ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰éŒ²éŸ³ | RunLoop `.common` ãƒ¢ãƒ¼ãƒ‰ |
| ã‚¿ã‚¤ãƒãƒ¼ç²¾åº¦ | é–‹å§‹æ™‚åˆ»ãƒ™ãƒ¼ã‚¹ã§ç´¯ç©èª¤å·®é˜²æ­¢ |

### Web

| é …ç›® | å¯¾ç­– |
|------|------|
| é•·æ–‡è¡¨ç¤º | ä»®æƒ³ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ« (react-virtual) |
| æ¤œç´¢ | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆæ¤œç´¢ â†’ å°†æ¥DBå…¨æ–‡æ¤œç´¢ |
| ã‚­ãƒ£ãƒƒã‚·ãƒ¥ | SWR / React Query |

### Supabase

| é …ç›® | å¯¾ç­– |
|------|------|
| ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ | user_id, created_at ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ |
| ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ | Edge Functions ã¯ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ¼ãƒ« |

---

**æœ€çµ‚æ›´æ–°**: 2026å¹´1æœˆ26æ—¥
