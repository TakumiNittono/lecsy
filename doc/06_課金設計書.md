# lecsy èª²é‡‘è¨­è¨ˆæ›¸

## ğŸ“‹ ç›®æ¬¡

1. [ãƒ“ã‚¸ãƒã‚¹ãƒ¢ãƒ‡ãƒ«](#ãƒ“ã‚¸ãƒã‚¹ãƒ¢ãƒ‡ãƒ«)
2. [ãƒ—ãƒ©ãƒ³è¨­è¨ˆ](#ãƒ—ãƒ©ãƒ³è¨­è¨ˆ)
3. [æ±ºæ¸ˆãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼](#æ±ºæ¸ˆãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼)
4. [Stripeé€£æº](#stripeé€£æº)
5. [ãƒ•ã‚§ã‚¢ãƒªãƒŸãƒƒãƒˆ](#ãƒ•ã‚§ã‚¢ãƒªãƒŸãƒƒãƒˆ)
6. [èª²é‡‘ãƒ•ãƒ­ãƒ¼](#èª²é‡‘ãƒ•ãƒ­ãƒ¼)

---

## ãƒ“ã‚¸ãƒã‚¹ãƒ¢ãƒ‡ãƒ«

### ã‚³ãƒ³ã‚»ãƒ—ãƒˆ

```
ã€Œç„¡æ–™ã§ã‚‚ååˆ†ä½¿ãˆã‚‹ â†’ ã§ã‚‚æ™‚é–“ç¯€ç´„ã¯æœ‰æ–™ã€
```

| å±¤ | ä¾¡å€¤ | èª²é‡‘ |
|---|------|------|
| éŒ²éŸ³ãƒ»æ–‡å­—èµ·ã“ã— | åŸºæœ¬æ©Ÿèƒ½ | ç„¡æ–™ï¼ˆç„¡åˆ¶é™ï¼‰ |
| Webé–²è¦§ãƒ»æ¤œç´¢ | åˆ©ä¾¿æ€§ | ç„¡æ–™ |
| AIè¦ç´„ãƒ»Exam Mode | æ™‚é–“ç¯€ç´„ | Proï¼ˆæœˆé¡ï¼‰ |

### åç›Šãƒ¢ãƒ‡ãƒ«

| æŒ‡æ¨™ | ç›®æ¨™ |
|------|------|
| MAU | 10,000+ |
| Proè»¢æ›ç‡ | 5% |
| Proæœˆé¡ | $2.99 |
| æœˆé–“åç›Šç›®æ¨™ | $1,500 |

---

## ãƒ—ãƒ©ãƒ³è¨­è¨ˆ

### Free ãƒ—ãƒ©ãƒ³

| æ©Ÿèƒ½ | åˆ¶é™ |
|------|------|
| éŒ²éŸ³ | ç„¡åˆ¶é™ |
| ãƒ­ãƒ¼ã‚«ãƒ«æ–‡å­—èµ·ã“ã— | ç„¡åˆ¶é™ |
| Webä¿å­˜ | ç„¡åˆ¶é™ |
| Webé–²è¦§ | ç„¡åˆ¶é™ |
| æ¤œç´¢ | ç„¡åˆ¶é™ |
| ã‚³ãƒ”ãƒ¼ | ç„¡åˆ¶é™ |
| ã‚¿ã‚¤ãƒˆãƒ«ç·¨é›† | ç„¡åˆ¶é™ |

### Pro ãƒ—ãƒ©ãƒ³ï¼ˆ$2.99/æœˆï¼‰

| æ©Ÿèƒ½ | åˆ¶é™ |
|------|------|
| Freeã®å…¨æ©Ÿèƒ½ | âœ… |
| AIè¦ç´„ï¼ˆSummarizeï¼‰ | ãƒ•ã‚§ã‚¢ãƒªãƒŸãƒƒãƒˆé©ç”¨ |
| Exam Mode | ãƒ•ã‚§ã‚¢ãƒªãƒŸãƒƒãƒˆé©ç”¨ |
| ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆï¼ˆå°†æ¥ï¼‰ | - |

### ä¾¡æ ¼æˆ¦ç•¥

| è¦ç´  | è¨­å®š | ç†ç”± |
|------|------|------|
| ä¾¡æ ¼ | $2.99/æœˆ | å­¦ç”Ÿã§ã‚‚æ‰•ãˆã‚‹ä¾¡æ ¼å¸¯ |
| å¹´é¡ | $29.99/å¹´ï¼ˆ16%ã‚ªãƒ•ï¼‰ | å°†æ¥è¿½åŠ æ¤œè¨ |
| ç„¡æ–™ãƒˆãƒ©ã‚¤ã‚¢ãƒ« | ãªã— | ç„¡æ–™æ©Ÿèƒ½ã§ååˆ†ä½“é¨“å¯èƒ½ |

---

## æ±ºæ¸ˆãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼

### é¸æŠè‚¢ã®æ¯”è¼ƒ

| ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ | æ‰‹æ•°æ–™ | ãƒ¡ãƒªãƒƒãƒˆ | ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ |
|-------------|--------|----------|-----------|
| **Stripe** | 2.9% + 30Â¢ | Webèª²é‡‘ã«æœ€é©ã€æŸ”è»Ÿ | iOSã‚¢ãƒ—ãƒªå†…èª²é‡‘ä¸å¯ |
| **App Store** | 15-30% | iOS nativeã€ä¿¡é ¼æ€§ | æ‰‹æ•°æ–™é«˜ã„ |

### æ¨å¥¨æ–¹é‡

```
Webèª²é‡‘ï¼ˆStripeï¼‰ã‚’ãƒ¡ã‚¤ãƒ³ã¨ã™ã‚‹
```

**ç†ç”±:**
1. æ‰‹æ•°æ–™ãŒå¤§å¹…ã«å®‰ã„ï¼ˆ2.9% vs 15-30%ï¼‰
2. Webã§èª²é‡‘ â†’ iOSã§ã‚‚Proæ©Ÿèƒ½ä½¿ç”¨å¯èƒ½
3. ã‚µãƒ–ã‚¹ã‚¯ç®¡ç†ãŒå®¹æ˜“

**æ³¨æ„:**
- iOSã‚¢ãƒ—ãƒªå†…ã§Stripeèª²é‡‘ã¸ã®èª˜å°ã¯è¦ç´„é•å
- iOSã‹ã‚‰ã¯Webã¸èª˜å°ã—ã€Webã§èª²é‡‘ã•ã›ã‚‹
- ã¾ãŸã¯ã€Œå¤–éƒ¨ãƒªãƒ³ã‚¯è¨±å¯ã€ç”³è«‹ï¼ˆReader Appç­‰ï¼‰

---

## Stripeé€£æº

### å•†å“ãƒ»ä¾¡æ ¼è¨­å®š

```
Product: lecsy Pro
â”œâ”€â”€ Price: $2.99/month (price_xxx)
â”‚   â”œâ”€â”€ Currency: USD
â”‚   â”œâ”€â”€ Billing: Monthly
â”‚   â””â”€â”€ Trial: None
â””â”€â”€ Price: $29.99/year (price_yyy) [å°†æ¥]
```

### ç’°å¢ƒå¤‰æ•°

```env
# Stripe Keys
STRIPE_PUBLISHABLE_KEY=pk_live_xxx
STRIPE_SECRET_KEY=sk_live_xxx
STRIPE_WEBHOOK_SECRET=whsec_xxx
STRIPE_PRICE_ID=price_xxx

# Supabase
NEXT_PUBLIC_SUPABASE_URL=https://xxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJ...
SUPABASE_SERVICE_ROLE_KEY=eyJ...
```

### Checkout Sessionä½œæˆ

```typescript
// app/api/create-checkout-session/route.ts

import { NextResponse } from "next/server";
import { createRouteHandlerClient } from "@supabase/auth-helpers-nextjs";
import { cookies } from "next/headers";
import Stripe from "stripe";

const stripe = new Stripe(process.env.STRIPE_SECRET_KEY!);

export async function POST(req: Request) {
  try {
    const supabase = createRouteHandlerClient({ cookies });
    const { data: { user } } = await supabase.auth.getUser();

    if (!user) {
      return NextResponse.json({ error: "Unauthorized" }, { status: 401 });
    }

    // æ—¢å­˜ã®Stripe Customerã‚’ç¢ºèª
    const { data: subscription } = await supabase
      .from("subscriptions")
      .select("stripe_customer_id")
      .eq("user_id", user.id)
      .single();

    let customerId = subscription?.stripe_customer_id;

    // ãªã‘ã‚Œã°ä½œæˆ
    if (!customerId) {
      const customer = await stripe.customers.create({
        email: user.email,
        metadata: { user_id: user.id },
      });
      customerId = customer.id;
    }

    // Checkout Sessionä½œæˆ
    const session = await stripe.checkout.sessions.create({
      customer: customerId,
      mode: "subscription",
      payment_method_types: ["card"],
      line_items: [
        {
          price: process.env.STRIPE_PRICE_ID!,
          quantity: 1,
        },
      ],
      success_url: `${process.env.NEXT_PUBLIC_APP_URL}/app?success=true`,
      cancel_url: `${process.env.NEXT_PUBLIC_APP_URL}/app?canceled=true`,
      metadata: {
        user_id: user.id,
      },
    });

    return NextResponse.json({ url: session.url });
  } catch (error) {
    console.error("Error:", error);
    return NextResponse.json(
      { error: "Internal server error" },
      { status: 500 }
    );
  }
}
```

### Customer Portalä½œæˆ

```typescript
// app/api/create-portal-session/route.ts

import { NextResponse } from "next/server";
import { createRouteHandlerClient } from "@supabase/auth-helpers-nextjs";
import { cookies } from "next/headers";
import Stripe from "stripe";

const stripe = new Stripe(process.env.STRIPE_SECRET_KEY!);

export async function POST(req: Request) {
  try {
    const supabase = createRouteHandlerClient({ cookies });
    const { data: { user } } = await supabase.auth.getUser();

    if (!user) {
      return NextResponse.json({ error: "Unauthorized" }, { status: 401 });
    }

    const { data: subscription } = await supabase
      .from("subscriptions")
      .select("stripe_customer_id")
      .eq("user_id", user.id)
      .single();

    if (!subscription?.stripe_customer_id) {
      return NextResponse.json(
        { error: "No subscription found" },
        { status: 404 }
      );
    }

    const portalSession = await stripe.billingPortal.sessions.create({
      customer: subscription.stripe_customer_id,
      return_url: `${process.env.NEXT_PUBLIC_APP_URL}/app/settings`,
    });

    return NextResponse.json({ url: portalSession.url });
  } catch (error) {
    console.error("Error:", error);
    return NextResponse.json(
      { error: "Internal server error" },
      { status: 500 }
    );
  }
}
```

---

## ãƒ•ã‚§ã‚¢ãƒªãƒŸãƒƒãƒˆ

### ç›®çš„

```
ã€ŒUnlimitedã€ã‚’è¬³ã„ã¤ã¤ã€æ‚ªç”¨ã‚’é˜²ã
```

### è¨­å®šå€¤

| ãƒªãƒŸãƒƒãƒˆ | å€¤ | ç†ç”± |
|---------|-----|------|
| 1æ—¥ã‚ãŸã‚Š | 20å› | 1æ—¥ã«20è¬›ç¾©è¦ç´„ã¯ååˆ† |
| æœˆã‚ãŸã‚Š | 400å› | æœˆ20æ—¥Ã—20å› |

### å®Ÿè£…

```typescript
// Edge Functionå†…ã§ãƒã‚§ãƒƒã‚¯

const DAILY_LIMIT = 20;
const MONTHLY_LIMIT = 400;

async function checkFairLimit(userId: string): Promise<boolean> {
  const supabase = getServiceClient();
  
  // ä»Šæ—¥ã®ä½¿ç”¨å›æ•°
  const today = new Date();
  today.setHours(0, 0, 0, 0);
  
  const { count: dailyCount } = await supabase
    .from("usage_logs")
    .select("*", { count: "exact", head: true })
    .eq("user_id", userId)
    .gte("created_at", today.toISOString());

  if ((dailyCount || 0) >= DAILY_LIMIT) {
    return false; // åˆ¶é™è¶…é
  }

  // ä»Šæœˆã®ä½¿ç”¨å›æ•°
  const monthStart = new Date(today.getFullYear(), today.getMonth(), 1);
  
  const { count: monthlyCount } = await supabase
    .from("usage_logs")
    .select("*", { count: "exact", head: true })
    .eq("user_id", userId)
    .gte("created_at", monthStart.toISOString());

  if ((monthlyCount || 0) >= MONTHLY_LIMIT) {
    return false; // åˆ¶é™è¶…é
  }

  return true; // OK
}
```

### ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

| çŠ¶æ…‹ | ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ |
|------|-----------|
| æ—¥æ¬¡åˆ¶é™ | "Today's limit reached. Try again tomorrow." |
| æœˆæ¬¡åˆ¶é™ | "Monthly limit reached. Limit resets on the 1st." |

### è¡¨ç¤ºã®ä»•æ–¹

- **è¡¨å‘ã**: ã€ŒUnlimitedã€
- **åˆ¶é™æ™‚ã®ã¿**: ä¸Šè¨˜ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
- **å°†æ¥**: ä½¿ç”¨é‡ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¿½åŠ æ¤œè¨

---

## èª²é‡‘ãƒ•ãƒ­ãƒ¼

### æ–°è¦èª²é‡‘ãƒ•ãƒ­ãƒ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒProæ©Ÿèƒ½ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. ProçŠ¶æ…‹ãƒã‚§ãƒƒã‚¯                                          â”‚
â”‚    isPro? â†’ Yes â†’ æ©Ÿèƒ½å®Ÿè¡Œ                                   â”‚
â”‚           â†’ No  â†’ ç¶šè¡Œ                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤º                                â”‚
â”‚    ã€ŒPro ã«ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã—ã¦ AI è¦ç´„ã‚’ä½¿ã†ã€                 â”‚
â”‚    [$2.99/æœˆ ã§ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰]                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. POST /api/create-checkout-session                        â”‚
â”‚    â†’ Stripe Checkout URL ã‚’å–å¾—                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. Stripe Checkout ãƒšãƒ¼ã‚¸ã¸ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ                      â”‚
â”‚    - ã‚«ãƒ¼ãƒ‰æƒ…å ±å…¥åŠ›                                          â”‚
â”‚    - æ±ºæ¸ˆå®Ÿè¡Œ                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. Stripe Webhook (checkout.session.completed)              â”‚
â”‚    â†’ subscriptions ãƒ†ãƒ¼ãƒ–ãƒ«æ›´æ–°                              â”‚
â”‚    â†’ status = 'active'                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. success_url ã¸ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ (/app?success=true)            â”‚
â”‚    â†’ æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º                                      â”‚
â”‚    â†’ Proæ©Ÿèƒ½ãŒå³åº§ã«æœ‰åŠ¹åŒ–                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è§£ç´„ãƒ•ãƒ­ãƒ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. è¨­å®š â†’ ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ç®¡ç†                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. POST /api/create-portal-session                          â”‚
â”‚    â†’ Stripe Customer Portal URL ã‚’å–å¾—                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. Stripe Customer Portal ã¸ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ                     â”‚
â”‚    - ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³è§£ç´„                                   â”‚
â”‚    - ã‚«ãƒ¼ãƒ‰æƒ…å ±å¤‰æ›´                                          â”‚
â”‚    - è«‹æ±‚å±¥æ­´ç¢ºèª                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. Stripe Webhook (customer.subscription.updated/deleted)   â”‚
â”‚    â†’ subscriptions ãƒ†ãƒ¼ãƒ–ãƒ«æ›´æ–°                              â”‚
â”‚    â†’ cancel_at_period_end = true or status = 'canceled'     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### çŠ¶æ…‹é·ç§»

```
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                                          â”‚
           â–¼                                          â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    checkout     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
    â”‚   free   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚  active  â”‚        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
           â–²                          â”‚              â”‚
           â”‚                          â”‚ cancel       â”‚
           â”‚                          â–¼              â”‚
           â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
           â”‚                    â”‚ canceled â”‚ â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  re-subscribe
           â”‚                          â”‚
           â”‚                          â”‚ period_end
           â”‚                          â–¼
           â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   free   â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### iOSã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ iOSã‚¢ãƒ—ãƒªå†…ã§Proæ©Ÿèƒ½ã®èª¬æ˜                                   â”‚
â”‚                                                             â”‚
â”‚ ã€ŒAIè¦ç´„ã‚’ä½¿ã†ã«ã¯ Pro ã¸ã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ãŒå¿…è¦ã§ã™ã€‚        â”‚
â”‚   Web (lecsy.app) ã‹ã‚‰ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚ã€             â”‚
â”‚                                                             â”‚
â”‚ [ Webã§ç¢ºèª ] â† Safari ã§ lecsy.app/app/settings ã‚’é–‹ã     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ã‚³ã‚¹ãƒˆè©¦ç®—

### AI API ã‚³ã‚¹ãƒˆï¼ˆOpenAI GPT-4 Turboï¼‰

| é …ç›® | å€¤ |
|------|-----|
| å…¥åŠ› | $0.01 / 1K tokens |
| å‡ºåŠ› | $0.03 / 1K tokens |
| 1è¬›ç¾©ã‚ãŸã‚Š | ç´„ $0.05-0.10 |

### åæ”¯ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

| é …ç›® | è¨ˆç®— | é‡‘é¡ |
|------|------|------|
| Proæœˆé¡ | - | $2.99 |
| Stripeæ‰‹æ•°æ–™ | 2.9% + $0.30 | -$0.39 |
| AI API (20å›/æœˆæƒ³å®š) | 20 Ã— $0.08 | -$1.60 |
| **ç´”åˆ©ç›Š/ãƒ¦ãƒ¼ã‚¶ãƒ¼** | - | **$1.00** |

### æç›Šåˆ†å²

- 1ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚ãŸã‚Šæœˆ20å›ä½¿ç”¨ã§ç´„$1åˆ©ç›Š
- æ¥µç«¯ãªãƒ˜ãƒ“ãƒ¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒ•ã‚§ã‚¢ãƒªãƒŸãƒƒãƒˆã§æŠ‘åˆ¶

---

**æœ€çµ‚æ›´æ–°**: 2026å¹´1æœˆ26æ—¥
